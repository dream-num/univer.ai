---
title: å®‰è£…å’Œå¼•å…¥
sidebar:
  order: 1
---

æˆ‘ä»¬æ¨èä½¿ç”¨ [Vite](https://vitejs.dev/)ã€[esbuild](https://esbuild.github.io/) æˆ– [Webpack 5](https://webpack.js.org/) ç­‰å¯¹ ES Module æ”¯æŒè¾ƒå¥½çš„æ„å»ºå·¥å…·æ¥æ„å»º Univer åº”ç”¨ã€‚å¦‚æœä½ ä½¿ç”¨äº†å…¶å®ƒæ„å»ºå·¥å…·ï¼ˆä¾‹å¦‚ Webpack 4ï¼‰ï¼Œå¯èƒ½ä¼šéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®ï¼Œè¯·é˜…è¯» [æ›´å¤š](/zh-cn/guides/quickstart/#æ›´å¤š) ä»¥åŠ [å¸¸è§é—®é¢˜](/zh-cn/guides/troubleshooting) è·å–æ›´å¤šä¿¡æ¯ã€‚

## å®‰è£…

Univer ä»¥æ’ä»¶çš„å½¢å¼æä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½ï¼Œé™¤äº†ä¸€äº›äº§å“æ‰€å¿…éœ€çš„æ ¸å¿ƒæ’ä»¶å¤–ï¼Œä½ è¿˜å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ€§åœ°å¼•å…¥å…¶å®ƒæ’ä»¶ã€‚

ä»¥ä¸‹ç¤ºä¾‹å°†ä¼šå¸¦ä½ äº†è§£å“ªäº›æ’ä»¶æ˜¯å¿…éœ€çš„ï¼Œä»¥åŠå¦‚ä½•å®‰è£…å®ƒä»¬ï¼š

:::tip
å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ npmï¼Œè¯·ç¡®ä¿ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º npm@7 ä»¥ä¸Šã€‚è¿™æ˜¯å› ä¸º npm@3 ~ npm@6 å¹¶ä¸ä¼šæ­£ç¡®åœ°å®‰è£… `peerDependencies`[^1]ã€‚
:::

import { Tabs, TabItem } from "@astrojs/starlight/components";

<Tabs>
  <TabItem label="ğŸ“Š Univer Sheet">
    ```shell
    # ä½¿ç”¨ npm
    npm install @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-ui @univerjs/ui

    # ä½¿ç”¨ pnpm
    pnpm add @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-ui @univerjs/ui
    ```
  </TabItem>
  <TabItem label="ğŸ“ Univer Doc">
    ```shell
    # ä½¿ç”¨ npm
    npm install @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/ui

    # ä½¿ç”¨ pnpm
    pnpm add @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/ui
    ```
  </TabItem>
</Tabs>

å¦‚æœä½ æƒ³åœ¨åç»­çš„å¼€å‘ä¸­è·å¾—æ›´åŠ ä¾¿æ·çš„å¼€å‘ä½“éªŒï¼Œæˆ‘ä»¬è¿˜æ¨èä½ å®‰è£… `@univerjs/facade`ï¼š

```shell
# ä½¿ç”¨ npm
npm install @univerjs/facade

# ä½¿ç”¨ pnpm
pnpm add @univerjs/facade
```

æœ‰å…³ `@univerjs/facade` çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒ [Facade](/zh-cn/guides/getting-started/facade) ç« èŠ‚ã€‚

## ä½¿ç”¨

import Sandbox from '@/components/Sandbox'

export const sheetCode = `const univer = new Univer({
  theme: defaultTheme,
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
  header: true,
  footer: true,
});

univer.registerPlugin(UniverDocsPlugin, {
  hasScroll: false,
});
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);

univer.createUniverSheet({});
`

export const docCode = `const univer = new Univer({
  theme: defaultTheme,
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
  header: true,
  footer: true,
});

univer.registerPlugin(UniverDocsPlugin, {
  standalone: true,
});
univer.registerPlugin(UniverDocsUIPlugin, {
  container: 'univerdoc',
  layout: {
    docContainerConfig: {
      innerLeft: false,
    },
  },
});

univer.createUniverDoc({});
`

<Tabs>
  <TabItem label="ğŸ“Š Univer Sheet">
    ç„¶ååˆ›å»ºä¸€ä¸ª Univer å®ä¾‹ï¼Œå¹¶æ³¨å†Œè¿™äº›æ’ä»¶ï¼š

    ```typescript title="main.ts"
    import "@univerjs/design/lib/index.css";
    import "@univerjs/ui/lib/index.css";
    import "@univerjs/docs-ui/lib/index.css";
    import "@univerjs/sheets-ui/lib/index.css";
    import "@univerjs/sheets-formula/lib/index.css";

    import { Univer } from "@univerjs/core";
    import { defaultTheme } from "@univerjs/design";

    import { UniverFormulaEnginePlugin } from "@univerjs/engine-formula";
    import { UniverRenderEnginePlugin } from "@univerjs/engine-render";

    import { UniverUIPlugin } from "@univerjs/ui";

    import { UniverDocsPlugin } from "@univerjs/docs";
    import { UniverDocsUIPlugin } from "@univerjs/docs-ui";

    import { UniverSheetsPlugin } from "@univerjs/sheets";
    import { UniverSheetsFormulaPlugin } from "@univerjs/sheets-formula";
    import { UniverSheetsUIPlugin } from "@univerjs/sheets-ui";
    ```

    ä½ éœ€è¦åœ¨é¡¹ç›®ä¸­å¼•å…¥ Univer çš„æ ·å¼æ–‡ä»¶ï¼Œä»¥åŠä¸€äº›å¿…è¦çš„æ’ä»¶ï¼š

    <Sandbox client:only="react" height="720px" src="/sandbox" code={sheetCode} />
  </TabItem>
  <TabItem label="ğŸ“ Univer Doc">
    ç„¶ååˆ›å»ºä¸€ä¸ª Univer å®ä¾‹ï¼Œå¹¶æ³¨å†Œè¿™äº›æ’ä»¶ï¼š

    ```typescript title="main.ts"
    import "@univerjs/design/lib/index.css";
    import "@univerjs/ui/lib/index.css";
    import "@univerjs/docs-ui/lib/index.css";

    import { Univer } from "@univerjs/core";
    import { defaultTheme } from "@univerjs/design";

    import { UniverFormulaEnginePlugin } from "@univerjs/engine-formula";
    import { UniverRenderEnginePlugin } from "@univerjs/engine-render";

    import { UniverUIPlugin } from "@univerjs/ui";

    import { UniverDocsPlugin } from "@univerjs/docs";
    import { UniverDocsUIPlugin } from "@univerjs/docs-ui";
    ```

    ä½ éœ€è¦åœ¨é¡¹ç›®ä¸­å¼•å…¥ Univer çš„æ ·å¼æ–‡ä»¶ï¼Œä»¥åŠä¸€äº›å¿…è¦çš„æ’ä»¶ï¼š

    <Sandbox client:only="react" height="720px" src="/sandbox" code={docCode} />
  </TabItem>
</Tabs>

## å…¥é—¨ç¤ºä¾‹ï¼šåŠ è½½æ•°æ®å’Œå­˜å‚¨æ•°æ®

<Tabs>
  <TabItem label="ğŸ“Š Univer Sheet">
    åœ¨ä¸Šä¸€å°èŠ‚çš„ä»£ç ä¸­ï¼Œä½ å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Univer å®ä¾‹å¹¶åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„ç”µå­è¡¨æ ¼ï¼Œä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½ å¯èƒ½éœ€è¦çš„æ˜¯åœ¨ Univer å½“ä¸­åŠ è½½å·²æœ‰æ•°æ®ã€‚è¿™ä¸€å°èŠ‚å°†ä¼šä»‹ç»å¦‚ä½•å‘ Univer åŠ è½½æ•°æ®ä»¥åŠå¦‚ä½•ä» Univer ä¸­å­˜å‚¨æ•°æ®ã€‚

    ### åŠ è½½æ•°æ®

    <Tabs>
      <TabItem label="ä½¿ç”¨ Facade API">
      </TabItem>
      <TabItem label="ä¸ä½¿ç”¨ Facade API">
        é€šè¿‡è°ƒç”¨ `Univer` çš„ `createUniverSheet` æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ `Workbook` å®ä¾‹ã€‚æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† `Workbook` çš„æ•°æ®ï¼Œåº”è¯¥ç¬¦åˆ `IWorkbookData` æ¥å£ã€‚

        ```typescript
        import { IWorkbookData } from "@univerjs/core";

        // ... create univer instance and load plugins

        const data: IWorkbookData = {};
        const workbook = univer.createUniverSheet(data);
        ```

        ä½ å¯ä»¥åœ¨[è¿™é‡Œ](/api/core/interfaces/IWorkbookData.html)äº†è§£ `IWorkbookData` æ‰€æ”¯æŒçš„å…¨éƒ¨å­—æ®µã€‚
      </TabItem>
    </Tabs>

    ### å­˜å‚¨æ•°æ®

    <Tabs>
      <TabItem label="ä½¿ç”¨ Facade API">
      </TabItem>
      <TabItem label="ä¸ä½¿ç”¨ Facade API">
        é€šè¿‡è°ƒç”¨ `Workbook` çš„ `save` æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ° `IWorkbookData` å¯¹è±¡ï¼ŒåŒ…å«äº†è¡¨æ ¼å†…éƒ¨çš„æ•°æ®ã€‚

        ```typescript
        const savedData = workbook.save();
        ```
      </TabItem>
    </Tabs>
  </TabItem>
</Tabs>


---

[^1]: https://blog.npmjs.org/post/110924823920/npm-weekly-5

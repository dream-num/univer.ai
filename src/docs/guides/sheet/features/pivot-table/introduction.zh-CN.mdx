import Image from '@/components/Image'
import pivot from './pivot.png'

# 数据透视表简介

数据透视表是一种数据处理工具，用于汇总、分析、探索和可视化大量数据。数据透视表可以帮助您快速分析数据，找出数据中的模式和关系，以便更好地理解数据。

数据透视表通常用于以下场景：

- 汇总数据：数据透视表可以帮助您快速汇总数据，以便更好地了解数据的整体情况。
- 分析数据：数据透视表可以帮助您分析数据，找出数据中的模式和关系。
- 探索数据：数据透视表可以帮助您探索数据，发现数据中的规律和趋势。
- 可视化数据：数据透视表可以帮助您将数据可视化，以便更好地理解数据。

数据透视表通常包含以下几个要素：

- 行标签：数据透视表中的行标签用于对数据进行分组。
- 列标签：数据透视表中的列标签用于对数据进行分组。
- 值：数据透视表中的值用于对数据进行汇总。

在数据透视表中，您可以根据需要对行标签、列标签和值进行调整，以便更好地分析数据。

<Image src={pivot} alt="Missing Locale" width={800} />

## 数据源

在univer sheet中，数据透视表的数据源可以是一个sheet，也可以是一个数据区域。您可以根据需要选择不同的数据源，以便更好地分析数据。
我们会以数据源的第一行作为默认的列标签，其他部分作为数据源。因此我们要求数据源尽可能的归整，尽可能避免空行，空列。
在同一列的数据中，我们会自动识别数据类型，以便更好的支持数据透视表的功能。假设在某一列中，数据类型不一致，我们会默认将该列的数据类型设置为字符串。

在univer sheet中，数据透视表会自动响应数据的变化，当数据源发生变化时，数据透视表会自动更新，以便更好地分析数据。

## 筛选

数据透视表支持对行标签和列标签进行筛选，同时提供筛选字段，该字段不会参与数据透视表主要数据分类汇总部分的排版，但是可以用于筛选数据。

数据透视表支持两种筛选方式：
- 标签筛选：标签筛选是直接作用于当前标签的维度的项(item)， 例如在省份维度下，我们可以过滤掉部分省份。
- 值筛选：值筛选需要指定一个值维度，然后会对值字段的汇总结果进行筛选，例如我们可以过滤掉销售额小于1000的数据。

## 排序

数据透视表的排序只会在行/列字段生效，排序方式支持升序和降序，排序方式使用localCompare方式。后续我们会支持更多的排序方式，例如拼音排序。

数据透视表的排序支持两种方式：
- 标签排序：标签排序是直接作用于当前标签的维度的项(item)， 例如在省份维度下，我们可以按照省份名称排序。
- 值排序：值排序需要指定一个值维度，然后会对值字段的汇总结果进行排序，例如我们可以按照销售额排序。

## 汇总

数据透视表支持11种excel支持的汇总方式，包括：求和、计数、数据计数、平均值、最大值、最小值、阶乘、标准差、方差、总体标准差、总体方差。

数据透视表支持多个值维度，同时可以定制多值维度所在区域(value position)和位置(value index)。

这是很复杂的排版逻辑， 因此我们仅支持了表格视图，后续我们会根据情况支持更多的视图。

## 下钻

数据透视表支持下钻功能，目前univer sheet尚未支持，不过很快就会支持。

下钻是指在数据透视表的值区域中，用户可以通过双击某个单元格，查看该单元格对应的详细数据。例如，用户可以在数据透视表中点击某个单元格，查看该单元格的详细数据，以便更好地追溯原数据。

## 分组

数据透视表支持分组功能，目前univer sheet尚未支持。

分组主要有以下三种方式：
- 日期分组：日期分组是指将日期数据按照年、月、日等单位进行分组。
- 数字分组：数字分组是指将数字数据按照一定的区间进行分组。
- 元素分组：元素分组是指将元素数据按照一定的规则进行分组。


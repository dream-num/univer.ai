import { Callout, Tabs } from 'nextra/components'
import BadgeGroup, { UniverTypes } from '@/components/BadgeGroup'
import Sandbox from '@/components/Sandbox'

import entryFile from './pivot-table/demo.txt'

# Pivot Table

<BadgeGroup values={[UniverTypes.SHEET]} value={UniverTypes.SHEET} />

<Sandbox entryFile={entryFile}  />

Pivot table is a powerful data analysis tool that can quickly summarize, organize and analyze large amounts of data, thereby helping users discover patterns and trends in the data.

- `@univerjs-pro/engine-pivot` provides the most basic data calculation capabilities for pivot tables. The plugin does not rely on any third-party plug-ins for its work.
- `@univerjs-pro/sheets-pivot` assembles engine-pivot into universal sheet plugin to support table rendering, collaboration, formulas and other capabilities
- `@univerjs-pro/sheets-pivot-ui` provides a basic drag-and-drop interface & filtering and other dialogs required for interaction

## Feature ability

<Callout>
Since PivotTable is a very complex and large-scale function, we currently provide a beta version and will continue to iterate in the future.
</Callout>

### Currently supported functions

- 11 subtotal methods supported like excel
- Dimension label filtering and sorting (using localCompare method)
- tabular layout
- expand / collapse
- Supports multiple value dimensions, and can customize the area (value position) and position (value index) of the multi-value dimension.
- rename field & format filed
- auto refresh when data source range change and dirty formula witch ref the pivot table area

### Planning features

- Group , the date group & element group & number group
- Filter & sort, support the value filter and value sort
- Show data as, support all kind of show data as type in excel
- Calc field & calc item
- Enhance the layout ability, support compact & outline layout, merge items and blank rows.

## Installation

<Tabs items={['pnpm', 'npm']}>
  <Tabs.Tab label="pnpm">
    ```shell
    pnpm add @univerjs-pro/engine-pivot  @univerjs-pro/sheets-pivot  @univerjs-pro/sheets-pivot-ui
    ```
  </Tabs.Tab>
  <Tabs.Tab label="npm">
    ```shell
    npm install @univerjs-pro/engine-pivot  @univerjs-pro/sheets-pivot  @univerjs-pro/sheets-pivot-ui
    ```
  </Tabs.Tab>
</Tabs>

## Import

```typescript
import '@univerjs-pro/sheets-pivot-ui/lib/index.css';

import { UniverSheetsPivotTablePlugin } from '@univerjs-pro/sheets-pivot';
import { UniverSheetsPivotTableUIPlugin } from '@univerjs-pro/sheets-pivot-ui';
```

## Internationalization

```typescript
import { LocaleType, Tools } from '@univerjs/core';
import SheetsPivotTableEnUS from '@univerjs-pro/sheets-pivot/locale/en-US';
import SheetsPivotTableUIEnUS from '@univerjs-pro/sheets-pivot-ui/locale/en-US';

const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.EN_US,
  locales: {
    [LocaleType.EN_US]: Tools.deepMerge(
      SheetsPivotTableEnUS,
      SheetsPivotTableUIEnUS
    ),
  },
});
```

## Register

```typescript
univer.registerPlugin(UniverSheetsPivotTablePlugin);
univer.registerPlugin(UniverSheetsPivotTableUIPlugin);
```

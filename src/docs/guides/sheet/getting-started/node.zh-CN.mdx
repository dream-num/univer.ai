import { Callout } from 'nextra/components'

# åœ¨ Node.js ä¸Šè¿è¡Œ Univer

Univer çš„åŒæ„ç‰¹æ€§ä½¿å¾—å®ƒä¸ä»…å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œå¹¶ä¸”å¯ä»¥åœ¨ Node.js ä¸Šè¿è¡Œ ğŸ‰ã€‚ä½ å¯ä»¥åŸºäº Univer on Node å¼€å‘æ•°æ®å¤„ç†æœåŠ¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆç”µå­è¡¨æ ¼ï¼Œæˆ–æ‰§è¡Œç”µå­è¡¨æ ¼çš„å…¬å¼ã€é€è§†è¡¨ç­‰è¿ç®—ï¼Œå¹¶é€šè¿‡ç†Ÿæ‚‰çš„ Facade API å’Œ Univer äº¤äº’ï¼Œè€Œè¿™ä¸€åˆ‡ä»…éœ€è¦è°ƒæ•´æ‰€åŠ è½½çš„æ’ä»¶ã€‚

## Presets

å¦‚æœä½ ä½¿ç”¨ Presets åŠ è½½ Univer on Nodeï¼Œå¯å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š

```ts
import process from 'node:process';
import { createUniver, LocaleType } from '@univerjs/presets';
import { UniverSheetsNodeBasicPreset } from '@univerjs/presets/sheets-node/sheets-node-basic/index';
import { zhCN } from '@univerjs/presets/sheets-node/sheets-node-basic/zh-CN';

async function run(): Promise<void> {
    const { univerAPI } = createUniver({
        locale: LocaleType.ZH_CN,
        presets: [
            UniverSheetsNodeBasicPreset({ locales: { zhCN } }),
        ],
    });
}

run();
```

[æ¡ˆä¾‹ä»“åº“]()

## é«˜çº§å¼•å…¥æ–¹å¼

å¯å‚è€ƒå¦‚ä¸‹ä»£ç å¯åŠ¨ Univer on Nodeï¼š

```ts
import { Univer, FUniver } from '@univerjs/core';
import { UniverDataValidationPlugin } from '@univerjs/data-validation';
import { UniverDocsPlugin } from '@univerjs/docs';
import { UniverDocsDrawingPlugin } from '@univerjs/docs-drawing';
import { UniverDrawingPlugin } from '@univerjs/drawing';
import { UniverFormulaEnginePlugin } from '@univerjs/engine-formula';
import { UniverRPCNodeMainPlugin } from '@univerjs/rpc-node';
import { UniverSheetsPlugin } from '@univerjs/sheets';
import { UniverSheetsConditionalFormattingPlugin } from '@univerjs/sheets-conditional-formatting';
import { UniverSheetsDataValidationPlugin } from '@univerjs/sheets-data-validation';
import { UniverSheetsDrawingPlugin } from '@univerjs/sheets-drawing';
import { UniverSheetsFilterPlugin } from '@univerjs/sheets-filter';
import { UniverSheetsFormulaPlugin } from '@univerjs/sheets-formula';
import { UniverSheetsHyperLinkPlugin } from '@univerjs/sheets-hyper-link';
import { UniverSheetsSortPlugin } from '@univerjs/sheets-sort';
import { UniverThreadCommentPlugin } from '@univerjs/thread-comment';

import '@univerjs/sheets/facade';
import '@univerjs/sheets-data-validation/facade';
import '@univerjs/engine-formula/facade';
import '@univerjs/sheets-filter/facade';
import '@univerjs/sheets-formula/facade';

export function createUniverOnNode(): Univer {
    const univer = new Univer();

    registerBasicPlugins(univer);
    registerSharedPlugins(univer);
    registerRPCPlugin(univer);
    registerDocPlugins(univer);
    registerSheetPlugins(univer);

    return univer;
}

function registerBasicPlugins(univer: Univer): void {
    univer.registerPlugin(UniverFormulaEnginePlugin);
}

function registerSharedPlugins(univer: Univer): void {
    univer.registerPlugin(UniverThreadCommentPlugin);
    univer.registerPlugin(UniverDrawingPlugin);
}

function registerDocPlugins(univer: Univer): void {
    univer.registerPlugin(UniverDocsPlugin);
    univer.registerPlugin(UniverDocsDrawingPlugin);
}

function registerSheetPlugins(univer: Univer): void {
    univer.registerPlugin(UniverSheetsPlugin);
    univer.registerPlugin(UniverSheetsFormulaPlugin);
    univer.registerPlugin(UniverSheetsConditionalFormattingPlugin);
    univer.registerPlugin(UniverDataValidationPlugin);
    univer.registerPlugin(UniverSheetsDataValidationPlugin);
    univer.registerPlugin(UniverSheetsFilterPlugin);
    univer.registerPlugin(UniverSheetsHyperLinkPlugin);
    univer.registerPlugin(UniverSheetsDrawingPlugin);
    univer.registerPlugin(UniverSheetsSortPlugin);
}

async function run(): Promise<void> {
    const univerAPI = FUniver.newAPI(createUniverOnNode());
}

run();
```

å¯ä»¥çœ‹åˆ°ï¼ŒUniver on Node åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªç§»é™¤äº†å’Œ UI ç›¸å…³çš„æ’ä»¶çš„ Univerï¼
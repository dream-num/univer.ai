import { Callout, Tabs } from 'nextra/components'
import ReactLive from '@/components/ReactLive'
import BadgeGroup, { UniverTypes } from '@/components/BadgeGroup'

# å®‰è£…å’Œå¼•å…¥

<BadgeGroup values={[UniverTypes.SHEET, UniverTypes.DOC, UniverTypes.SLIDE]} value={UniverTypes.SHEET} />

## ä½¿ç”¨åŒ…ç®¡ç†å™¨

å¦‚æœä½ å¯¹ç°ä»£å‰ç«¯å¼€å‘æœ‰æ‰€äº†è§£ï¼Œé‚£ä¹ˆä½¿ç”¨åŒ…ç®¡ç†å·¥å…·æ¥æ„å»ºåŒ…å« Univer çš„åº”ç”¨å°†ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

æˆ‘ä»¬æ¨èä½¿ç”¨ [Vite](https://vitejs.dev/)ã€[esbuild](https://esbuild.github.io/) æˆ– [Webpack 5](https://webpack.js.org/) ç­‰å¯¹ ES Module æ”¯æŒè¾ƒå¥½çš„æ„å»ºå·¥å…·æ¥æ„å»º Univer åº”ç”¨ã€‚å¦‚æœä½ ä½¿ç”¨äº†å…¶å®ƒæ„å»ºå·¥å…·ï¼ˆä¾‹å¦‚ Webpack 4ï¼‰ï¼Œå¯èƒ½ä¼šéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®ï¼Œè¯·é˜…è¯» [å¸¸è§é—®é¢˜](/guides/sheet/troubleshooting) è·å–æ›´å¤šä¿¡æ¯ã€‚

### å®‰è£…

Univer ä»¥æ’ä»¶çš„å½¢å¼æä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½ï¼Œé™¤äº†ä¸€äº›äº§å“æ‰€å¿…éœ€çš„æ ¸å¿ƒæ’ä»¶å¤–ï¼Œä½ è¿˜å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ€§åœ°å¼•å…¥å…¶å®ƒæ’ä»¶ã€‚

<Callout>
  - å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ npmï¼Œè¯·ç¡®ä¿ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º npm@7 åŠä»¥ä¸Šã€‚è¿™æ˜¯å› ä¸º npm@3 ~ npm@6 å¹¶ä¸ä¼šæ­£ç¡®åœ°å®‰è£… `peerDependencies`[^1]ã€‚
  - å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ pnpmï¼Œè¯·ç¡®ä¿ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º pnpm@8 åŠä»¥ä¸Šã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ pnpm@6 ~ pnpm@7ï¼Œå¯ä»¥å°è¯•é…ç½® `auto-install-peers=true` [^2]æ¥è§£å†³ä¾èµ–å®‰è£…é—®é¢˜ã€‚
  - å·²çŸ¥é—®é¢˜ï¼šyarn ä¸æ”¯æŒè‡ªåŠ¨å®‰è£… `peerDependencies`[^3]ï¼Œå¹¶ä¸”ä¼¼ä¹æ²¡æœ‰å¯é çš„è§£å†³æ–¹æ¡ˆã€‚è¯·æ ¹æ®æ§åˆ¶å°çš„æç¤ºæ‰‹åŠ¨å®‰è£…ç¼ºå¤±çš„ä¾èµ–ã€‚
</Callout>

ä»¥ä¸‹ç¤ºä¾‹å°†ä¼šå¸¦ä½ äº†è§£å“ªäº›æ’ä»¶æ˜¯å¿…éœ€çš„ï¼Œä»¥åŠå¦‚ä½•å®‰è£…å®ƒä»¬ï¼š

<Tabs items={['pnpm', 'npm']}>
  <Tabs.Tab label="pnpm">
    ```shell
    pnpm add @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-ui @univerjs/ui
    ```
  </Tabs.Tab>
  <Tabs.Tab label="npm">
    ```shell
    npm install @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-ui @univerjs/ui
    ```
  </Tabs.Tab>
</Tabs>

å¦‚æœä½ æƒ³åœ¨åç»­çš„å¼€å‘ä¸­è·å¾—æ›´åŠ ä¾¿æ·çš„å¼€å‘ä½“éªŒï¼Œæˆ‘ä»¬è¿˜æ¨èä½ å®‰è£… `@univerjs/facade`ï¼š

<Tabs items={['pnpm', 'npm']}>
  <Tabs.Tab label="pnpm">
    ```shell
    pnpm add @univerjs/facade
    ```
  </Tabs.Tab>
  <Tabs.Tab label="npm">
    ```shell
    npm install @univerjs/facade
    ```
  </Tabs.Tab>
</Tabs>

æœ‰å…³ `@univerjs/facade` çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒ [Facade](/guides/sheet/facade/facade) ç« èŠ‚ã€‚

### æ›´æ–°

ç”±äº Univer ä½¿ç”¨äº† monorepo çš„æ–¹å¼è¿›è¡Œç®¡ç†ï¼Œæ¯æ¬¡å‘å¸ƒéƒ½ä¼šæ›´æ–°æ‰€æœ‰å®˜æ–¹æ’ä»¶çš„ç‰ˆæœ¬å·ã€‚å› æ­¤åœ¨æ›´æ–° Univer æ—¶ï¼Œä½ åº”å½“åŒæ—¶æ›´æ–°æ‰€æœ‰çš„æ’ä»¶ï¼Œä¿è¯å®ƒä»¬çš„ç‰ˆæœ¬å·ä¸€è‡´ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ pnpmï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ›´æ–°æ‰€æœ‰çš„æ’ä»¶ï¼š

```shell
pnpm update "@univerjs/*"@latest
```

### ä½¿ç”¨

<Callout>
  æ ·å¼æ–‡ä»¶çš„å¼•å…¥é¡ºåºå¾ˆé‡è¦ï¼Œç¡®ä¿ä½ åœ¨ä¾æ¬¡å¼•å…¥ `@univerjs/design`ã€`@univerjs/ui` çš„ CSS æ ·å¼åå†å¼•å…¥å…¶ä»–æ’ä»¶çš„æ ·å¼æ–‡ä»¶ã€‚
</Callout>

ä½ éœ€è¦åœ¨é¡¹ç›®ä¸­å¼•å…¥ Univer çš„æ ·å¼æ–‡ä»¶ã€è¯­è¨€åŒ…ï¼Œä»¥åŠä¸€äº›å¿…è¦çš„æ’ä»¶ï¼š

```typescript
import "@univerjs/design/lib/index.css";
import "@univerjs/ui/lib/index.css";
import "@univerjs/docs-ui/lib/index.css";
import "@univerjs/sheets-ui/lib/index.css";
import "@univerjs/sheets-formula/lib/index.css";

import { LocaleType, Tools, Univer, UniverInstanceType } from "@univerjs/core";
import { defaultTheme } from "@univerjs/design";

import { UniverFormulaEnginePlugin } from "@univerjs/engine-formula";
import { UniverRenderEnginePlugin } from "@univerjs/engine-render";

import { UniverUIPlugin } from "@univerjs/ui";

import { UniverDocsPlugin } from "@univerjs/docs";
import { UniverDocsUIPlugin } from "@univerjs/docs-ui";

import { UniverSheetsPlugin } from "@univerjs/sheets";
import { UniverSheetsFormulaPlugin } from "@univerjs/sheets-formula";
import { UniverSheetsUIPlugin } from "@univerjs/sheets-ui";

import DesignZhCN from '@univerjs/design/locale/zh-CN';
import UIZhCN from '@univerjs/ui/locale/zh-CN';
import DocsUIZhCN from '@univerjs/docs-ui/locale/zh-CN';
import SheetsZhCN from '@univerjs/sheets/locale/zh-CN';
import SheetsUIZhCN from '@univerjs/sheets-ui/locale/zh-CN';
import SheetsFormulaZhCN from '@univerjs/sheets-formula/locale/zh-CN';
```

<Callout type="info" emoji="â„¹ï¸">
  å¤§é‡æ’ä»¶çš„è¯­è¨€åŒ…å’Œæ ·å¼åŠ è½½å¯èƒ½ä¼šä½¿å¼€å‘å˜å¾—ç¹çä¸”éš¾ä»¥ç»´æŠ¤ã€‚æˆ‘ä»¬æä¾›äº† Univer Plugins æ¥å¸®åŠ©ä½ æ›´åŠ æ–¹ä¾¿åœ°å¼•å…¥æ’ä»¶ï¼Œè¯¦æƒ…è¯·å‚è€ƒ [ç®€åŒ–å¼•å…¥](/guides/sheet/getting-started/univer-plugins) ç« èŠ‚ã€‚
</Callout>

ç„¶ååˆ›å»ºä¸€ä¸ª Univer å®ä¾‹ï¼Œå¹¶æ³¨å†Œè¿™äº›æ’ä»¶ï¼š

```typescript
const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: Tools.deepMerge(
      SheetsZhCN,
      DocsUIZhCN,
      SheetsUIZhCN,
      SheetsFormulaZhCN,
      UIZhCN,
      DesignZhCN,
    ),
  },
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
});

univer.registerPlugin(UniverDocsPlugin, {
  hasScroll: false,
});
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);

univer.createUnit(UniverInstanceType.UNIVER_SHEET, {});
```

export const code = `const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: zhCN,
  },
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
});

univer.registerPlugin(UniverDocsPlugin, {
  hasScroll: false,
});
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);

univer.createUnit(UniverInstanceType.UNIVER_SHEET, {});`

<ReactLive code={code} />

## é€šè¿‡ CDN å¼•å…¥

å¦‚æœä½ ä¸æƒ³ä½¿ç”¨åŒ…ç®¡ç†å·¥å…·ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ CDN å¼•å…¥ Univer çš„æ ·å¼æ–‡ä»¶ã€è¯­è¨€åŒ…å’Œæ’ä»¶ã€‚Univer ä¸ºæ¯ä¸€ä¸ªæ’ä»¶éƒ½æä¾›äº†å•ç‹¬çš„ UMD æ„å»ºã€‚å½“ç„¶ï¼Œçç¢çš„ UMD åŒ…ä¼šä½¿å¾—å¼€å‘è€…æ‹¥æœ‰éå¸¸çµæ´»çš„é€‰æ‹©æƒï¼Œä½†ä¹ŸåŒæ ·ä¼šè®©å¼€å‘è€…é¢ä¸´ä¸€äº›æ–°çš„æŒ‘æˆ˜ï¼š

- æˆ‘è¦å¦‚ä½•ç¡®å®šä¸€ä¸ªåŒ…çš„å‰ç½®ä¾èµ–ï¼Ÿ
- æˆ‘è¦å¦‚ä½•ç¡®å®šæ­£ç¡®çš„å¼•å…¥é¡ºåºï¼Ÿ
- æˆ‘è¦å¦‚ä½•ç¡®å®šä¸€ä¸ªåŠŸèƒ½ç©¶ç«Ÿæ˜¯ç”±å“ªäº›åŒ…æä¾›çš„ï¼Ÿ

å¦‚æœå¯¹ Univer çš„æ’ä»¶åŒ–æœºåˆ¶æ²¡æœ‰ä¸€ä¸ªéå¸¸æ¸…æ™°çš„äº†è§£çš„è¯ï¼Œé€šå¸¸æ¥è¯´è¿™äº›é—®é¢˜çš„èƒŒåå°±æ„å‘³ç€æ— æ•°ç§æ’åˆ—ç»„åˆå°è¯•çš„è¿‡ç¨‹ã€‚

å› æ­¤ï¼ŒUniver ä¹Ÿæä¾›äº†ä¸€ä¸ªåŒ…å«äº†æ‰€æœ‰æ’ä»¶çš„ UMD æ„å»ºï¼Œä½ å¯ä»¥åœ¨ HTML æ–‡ä»¶ä¸­å¼•å…¥è¿™ä¸ª UMD æ„å»ºï¼Œç„¶åé€šè¿‡ `window` å¯¹è±¡æ¥è®¿é—®å„ä¸ªæ’ä»¶ã€‚

### ç¤ºä¾‹

å½“å‰ä¸»æµçš„ CDN æœåŠ¡å•†ï¼ˆä¾‹å¦‚ jsDelivrã€unpkgï¼‰éƒ½æ”¯æŒ Univer çš„ UMD æ„å»ºï¼Œä½ å¯ä»¥åœ¨ HTML æ–‡ä»¶ä¸­å¼•å…¥è¿™äº›èµ„æºï¼š

```html
<head>
  <script src="https://unpkg.com/@univerjs/umd/lib/univer.full.umd.js"></script>
  <script src="https://unpkg.com/@univerjs/umd/lib/locale/zh-CN.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/umd/lib/univer.css">
</head>
<body>
  <div id="app"></div>
 
  <script>
    var {
      UniverCore,
      UniverDesign,
      UniverEngineRender,
      UniverEngineFormula,
      UniverDocs,
      UniverDocsUi,
      UniverUi,
      UniverSheets,
      UniverSheetsUi,
      UniverSheetsNumfmt,
      UniverSheetsFormula,
      UniverFacade,
    } = window
 
    var univer = new UniverCore.Univer({
      theme: UniverDesign.defaultTheme,
      locale: UniverCore.LocaleType.ZH_CN,
      locales: {
        [UniverCore.LocaleType.ZH_CN]: UniverUMD['zh-CN'],
      },
    });
 
    univer.registerPlugin(UniverEngineRender.UniverRenderEnginePlugin);
    univer.registerPlugin(UniverEngineFormula.UniverFormulaEnginePlugin);
 
    univer.registerPlugin(UniverUi.UniverUIPlugin, {
      container: "app",
    });
 
    univer.registerPlugin(UniverDocs.UniverDocsPlugin, {
      hasScroll: false,
    });
    univer.registerPlugin(UniverDocsUi.UniverDocsUIPlugin);
 
    univer.registerPlugin(UniverSheets.UniverSheetsPlugin);
    univer.registerPlugin(UniverSheetsUi.UniverSheetsUIPlugin);
    univer.registerPlugin(UniverSheetsNumfmt.UniverSheetsNumfmtPlugin);
    univer.registerPlugin(UniverSheetsFormula.UniverSheetsFormulaPlugin);
 
    univer.createUnit(UniverCore.UniverInstanceType.UNIVER_SHEET, {})
 
    const univerAPI = UniverFacade.FUniver.newAPI(univer)
  </script>
</body>
```

ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡ CDN å¼•å…¥ Univer çš„æ–¹å¼å’Œä½¿ç”¨åŒ…ç®¡ç†å·¥å…·å¼•å…¥çš„æ–¹å¼åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯æ¯ä¸ªæ’ä»¶éƒ½æœ‰å±äºè‡ªå·±çš„å‘½åç©ºé—´ã€‚é€šå¸¸è¿™äº›å‘½åç©ºé—´çš„å‘½åè§„åˆ™ä¸ºå¤§å†™é©¼å³°çš„ `Univer<PluginName>`ã€‚

### ç²¾ç®€ç‰ˆæœ¬

å¦‚æœä½ çš„é¡¹ç›®ä¸­å·²ç»ä½¿ç”¨äº† Reactã€ReactDOM å’Œ RxJSï¼Œä½ å¯ä»¥é€‰æ‹© UMD åŒ…çš„ç²¾ç®€ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ä¸åŒ…å«è¿™äº›ä¾èµ–é¡¹ã€‚

```diff
+ <script src="https://unpkg.com/react/umd/react.production.min.js"></script>
+ <script src="https://unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
+ <script src="https://unpkg.com/rxjs/dist/bundles/rxjs.umd.min.js"></script>
 
- <script src="https://unpkg.com/@univerjs/umd/lib/univer.full.umd.js"></script>
+ <script src="https://unpkg.com/@univerjs/umd/lib/univer.slim.umd.js"></script>
<link rel="stylesheet" href="https://unpkg.com/@univerjs/umd/lib/univer.css">
```

### æŒ‡å®šç‰ˆæœ¬

unpkg å’Œ jsDeliver éƒ½æ”¯æŒæŒ‡å®šç‰¹å®šç‰ˆæœ¬çš„èµ„æºã€‚ä»¥ unpkg ä¸ºä¾‹ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ 0.1.16 ç‰ˆæœ¬çš„ Univerï¼Œä»…éœ€åœ¨ URL ä¸­åŠ ä¸Š `@<version>` æ¥æŒ‡å®šç‰ˆæœ¬å³å¯ï¼š

```diff
- https://unpkg.com/@univerjs/umd/lib/univer.full.umd.js
+ https://unpkg.com/@univerjs/umd@0.1.16/lib/univer.full.umd.js
```

## å…¥é—¨ç¤ºä¾‹ï¼šåŠ è½½æ•°æ®ã€ä¿®æ”¹æ•°æ®å’Œå­˜å‚¨æ•°æ®

åœ¨ä¸Šä¸€å°èŠ‚çš„ä»£ç ä¸­ï¼Œä½ å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Univer å®ä¾‹å¹¶åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„ç”µå­è¡¨æ ¼ï¼Œä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½ å¯èƒ½éœ€è¦çš„æ˜¯åœ¨ Univer å½“ä¸­åŠ è½½å·²æœ‰æ•°æ®ã€‚è¿™ä¸€å°èŠ‚å°†ä¼šä»‹ç»å¦‚ä½•å‘ Univer åŠ è½½æ•°æ®ã€ä¿®æ”¹æ•°æ®ä»¥åŠå¦‚ä½•ä» Univer ä¸­å­˜å‚¨æ•°æ®ã€‚

### åŠ è½½æ•°æ®

é€šè¿‡è°ƒç”¨ `Univer` çš„ `createUniverSheet` æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ `Workbook` å®ä¾‹ã€‚æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† `Workbook` çš„æ•°æ®ï¼Œåº”è¯¥ç¬¦åˆ `IWorkbookData` æ¥å£ã€‚

```typescript
import { IWorkbookData, UniverInstanceType } from "@univerjs/core";

const data: IWorkbookData = {};
const workbook = univer.createUnit(UniverInstanceType.UNIVER_SHEET, data);
```

ä½ å¯ä»¥åœ¨[è¿™é‡Œ](/typedoc/@univerjs/core/interfaces/IWorkbookData)äº†è§£ `IWorkbookData` æ‰€æ”¯æŒçš„å…¨éƒ¨å­—æ®µã€‚

### ä¿®æ”¹æ•°æ®

<Callout type="error" emoji="ğŸš¨">
  Univer åŸºäº[å‘½ä»¤ç³»ç»Ÿ](/guides/sheet/architecture/univer#%E5%91%BD%E4%BB%A4%E7%B3%BB%E7%BB%9F)å¯¹çŠ¶æ€å’Œæ•°æ®è¿›è¡Œæ“ä½œå’Œæ›´æ–°ï¼Œå› æ­¤ä½ **å¿…é¡»**åˆç†åœ°ä½¿ç”¨å‘½ä»¤æˆ–è€…ç›¸åº”çš„ Facade API æ¥æ›´æ–°æ•°æ®ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹æ•°æ®ã€‚ä»»ä½•ç›´æ¥å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ä»¥æœŸæœ›æ›´æ–°è§†å›¾çš„æ“ä½œéƒ½æ˜¯ä¸è¢«å…è®¸çš„ã€‚
</Callout>

`@univerjs/facade` æä¾›çš„ API æ˜¯å¯¹ `Univer` å®ä¾‹çš„å°è£…ï¼Œå› æ­¤ä½ éœ€è¦åœ¨åˆ›å»ºäº† `Univer` å®ä¾‹ä¹‹åï¼Œå†ç”¨ `FUniver` åŒ…è£¹è¿™ä¸ªå®ä¾‹ï¼š

```typescript
import { FUniver } from "@univerjs/facade";

const univerAPI = FUniver.newAPI(univer);
```

ç„¶åä½ å°±å¯ä»¥é€šè¿‡è°ƒç”¨ `univerAPI` çš„æ–¹æ³•æ¥ä½¿ç”¨ Univer äº†ï¼Œä¾‹å¦‚è·å–å½“å‰æ¿€æ´»çš„ sheetï¼Œå¹¶åœ¨æŒ‡å®šçš„èŒƒå›´æ›´æ–°å€¼ï¼š

```typescript
const sheet = univerAPI.getActiveWorkbook().getActiveSheet();

// A1 è®¾ç½®æ•°å­— 1
const range = sheet.getRange(0, 0, 1, 1);
range.setValue(1);
```

### å­˜å‚¨æ•°æ®

é€šè¿‡è°ƒç”¨å½“å‰ `Workbook` çš„ `save` æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ° `IWorkbookData` å¯¹è±¡ï¼ŒåŒ…å«äº†è¡¨æ ¼å†…éƒ¨çš„æ•°æ®ã€‚

```typescript
const savedData = univerAPI.getActiveWorkbook().save();
```

---

[^1]: https://blog.npmjs.org/post/110924823920/npm-weekly-5
[^2]: https://pnpm.io/npmrc#auto-install-peers
[^3]: https://github.com/yarnpkg/yarn/issues/1503

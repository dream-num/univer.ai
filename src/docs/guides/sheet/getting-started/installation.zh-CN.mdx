import { Callout, Tabs } from 'nextra/components'
import ReactLive from '@/components/ReactLive'
import BadgeGroup, { UniverTypes } from '@/components/BadgeGroup'

# å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨

<BadgeGroup values={[UniverTypes.SHEET, UniverTypes.DOC, UniverTypes.SLIDE]} value={UniverTypes.SHEET} />

Univer ä» 0.5.0 ç‰ˆæœ¬èµ·æä¾›äº† `@univerjs/presets` åŒ…ï¼Œå®ƒé’ˆå¯¹ä¸€äº›å¸¸è§åœºæ™¯æä¾›äº†é¢„è®¾çš„é…ç½®ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ª Univer åº”ç”¨è€Œæ— éœ€å…³å¿ƒå¦‚ä½•å¼•å…¥å’Œé…ç½® Univer æ’ä»¶ã€‚

<Callout type="info" emoji="ğŸƒ">
  å¦‚æœä½ æ˜¯é¦–æ¬¡ä½¿ç”¨ Univerï¼Œæˆ‘ä»¬æ¨èä» Presets å¼€å§‹ã€‚åœ¨åç»­çš„å°èŠ‚ä¸­ï¼Œé™¤éç‰¹æ®Šè¯´æ˜ï¼Œæˆ‘ä»¬éƒ½ä¼šå‡è®¾ä½ ä½¿ç”¨äº† Presetsã€‚å¦‚æœä½ å·²ç»è¾ƒä¸ºç†Ÿæ‚‰ Univerï¼Œå¹¶ä¸”å¸Œæœ›æ›´åŠ çµæ´»åœ°å¼•å…¥æ’ä»¶ï¼ˆä¾‹å¦‚æ‡’åŠ è½½éƒ¨åˆ†æ’ä»¶ï¼‰ï¼Œå¯ä»¥å‚è€ƒ [é«˜çº§å¼•å…¥æ–¹å¼](/guides/sheet/advanced-installation)ã€‚
</Callout>

## ä½¿ç”¨åŒ…ç®¡ç†å™¨

å¦‚æœä½ çš„é¡¹ç›®ä¸­å·²ç»å¼•å…¥äº†ç°ä»£å‰ç«¯å¼€å‘å·¥å…·ï¼Œé‚£ä¹ˆå¼•å…¥ Univer å°†ä¼šéå¸¸ç®€å•ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨ [Vite](https://vitejs.dev/)ã€[esbuild](https://esbuild.github.io/) æˆ– [Webpack 5](https://webpack.js.org/) ç­‰å¯¹ ES Module æ”¯æŒè¾ƒå¥½çš„æ„å»ºå·¥å…·æ¥æ„å»º Univer åº”ç”¨ã€‚å¦‚æœä½ ä½¿ç”¨äº†å…¶å®ƒæ„å»ºå·¥å…·ï¼ˆä¾‹å¦‚ Webpack 4ï¼‰ï¼Œå¯èƒ½ä¼šéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®ï¼Œè¯·é˜…è¯» [å¸¸è§é—®é¢˜](/guides/sheet/troubleshooting) è·å–æ›´å¤šä¿¡æ¯ã€‚

### å®‰è£…

é€‰æ‹©ä½ æ‰€ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ä»¥å®‰è£… `@unvierjs/presets`ï¼š

<Tabs items={['pnpm', 'npm', 'yarn']}>
  <Tabs.Tab label="pnpm">
    ```shell
    pnpm add @univerjs/presets
    ```
  </Tabs.Tab>
  <Tabs.Tab label="npm">
    ```shell
    npm install @univerjs/presets
    ```
  </Tabs.Tab>
  <Tabs.Tab label="yarn">
    ```shell
    yarn add @univerjs/presets
    ```
  </Tabs.Tab>
</Tabs>

### ä½¿ç”¨

ä»…ä»…åå‡ è¡Œä»£ç ï¼Œä½ å°±å¯ä»¥å¯åŠ¨ä¸€ä¸ªç”µå­è¡¨æ ¼åº”ç”¨å¹¶åŠ è½½ç”µå­è¡¨æ ¼çš„åŸºç¡€åŠŸèƒ½ï¼š

```typescript
import { LocaleType, LogLevel } from '@univerjs/core';
import { defaultTheme } from '@univerjs/design';
import { createUniver } from '@univerjs/presets';
import { UniverSheetsBasicPreset } from '@univerjs/presets/sheets/sheets-basic';
import { enUS } from '@univerjs/presets/sheets/sheets-basic/en-US';

const { univerAPI } = createUniver({
    locale: LocaleType.ZH_CN, // set default locale 
    theme: defaultTheme, // set theme
    presets: [
        UniverSheetsBasicPreset({ locales: { enUS }, container: 'app' }),
    ],
});

univerAPI.createUniverSheet({ name: 'Test Sheet' });
```

export const code = `const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: zhCN,
  },
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
});

univer.registerPlugin(UniverDocsPlugin);
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);

univer.createUnit(UniverInstanceType.UNIVER_SHEET, {});`

<ReactLive code={code} />

### æ›´æ–°

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ pnpmï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ›´æ–°æ‰€æœ‰çš„æ’ä»¶ï¼š

```shell
pnpm update "@univerjs/presets" @latest
```

## é€šè¿‡ `<script>` æ ‡ç­¾å¼•å…¥

å¦‚æœä½ ä¸ä½¿ç”¨åŒ…ç®¡ç†å·¥å…·ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ `<script>` æ ‡ç­¾å¼•å…¥ Univerã€‚

### ç¤ºä¾‹

æˆ‘ä»¬åœ¨å½“å‰ä¸»æµçš„ CDN æœåŠ¡å•†ï¼ˆä¾‹å¦‚ jsDelivrã€unpkgï¼‰éƒ½æä¾›äº† Univer çš„ UMD æ„å»ºï¼Œä½ å¯ä»¥åœ¨ HTML æ–‡ä»¶ä¸­å¼•å…¥è¿™äº›èµ„æºï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸‹è½½è¿™äº›æ–‡ä»¶ç„¶åé€šè¿‡è‡ªå·±çš„æœåŠ¡å™¨æˆ–è€… CDN ç½‘ç»œåˆ†å‘ï¼‰ï¼š

<Callout type="error">
  TODO: @jikkai è¿™é‡Œéœ€è¦ç»™ presets æ‰“ UMD åŒ…å¹¶æŒ‡å¯¼ç”¨æˆ·å¼•å…¥
</Callout>

```html
<head>
  <script src="https://unpkg.com/@univerjs/umd/lib/univer.full.umd.js"></script>
  <script src="https://unpkg.com/@univerjs/umd/lib/locale/zh-CN.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/umd/lib/univer.css">
</head>
<body>
  <div id="app"></div>
 
  <script>
    const { univerAPI } = createUniver({
    logLevel: LogLevel.INFO, // set log level
    locale: LocaleType.ZH_CN, // set default locale 
    theme: defaultTheme, // set theme
    presets: [
        UniverSheetsBasicPreset({ locales: { enUS }, container: 'app' }), // univer container id
      ],
    });

    univerAPI.createUniverSheet({ name: 'Test Sheet' }); // create your first sheet
  </script>
</body>
```

è¿™é‡Œè¿”å›çš„ `univerAPI` å¯¹è±¡è¢«ç§°ä¸º Univer çš„é¢æ¿ APIï¼ˆFacade APIï¼‰ï¼Œé€šè¿‡å®ƒå¯ä»¥è°ƒç”¨ Univer æä¾›çš„è®¸å¤šåŠŸèƒ½ã€‚

### æŒ‡å®šç‰ˆæœ¬

unpkg å’Œ jsDeliver éƒ½æ”¯æŒæŒ‡å®šç‰¹å®šç‰ˆæœ¬çš„èµ„æºã€‚ä»¥ unpkg ä¸ºä¾‹ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ 0.1.16 ç‰ˆæœ¬çš„ Univerï¼Œä»…éœ€åœ¨ URL ä¸­åŠ ä¸Š `@<version>` æ¥æŒ‡å®šç‰ˆæœ¬å³å¯ï¼š

```diff
- https://unpkg.com/@univerjs/umd/lib/univer.full.umd.js
+ https://unpkg.com/@univerjs/umd@0.1.16/lib/univer.full.umd.js
```

## è¡¨æ ¼åŸºæœ¬æ“ä½œ

åœ¨ä¸Šä¸€å°èŠ‚çš„ä»£ç ä¸­ï¼Œä½ å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Univer å®ä¾‹å¹¶åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„ç”µå­è¡¨æ ¼ï¼Œä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½ å¯èƒ½éœ€è¦çš„æ˜¯åœ¨ Univer å½“ä¸­åŠ è½½å·²æœ‰æ•°æ®ã€‚è¿™ä¸€å°èŠ‚å°†ä¼šä»‹ç»å¦‚ä½•å‘ Univer åŠ è½½æ•°æ®ã€ä¿®æ”¹æ•°æ®ä»¥åŠå¦‚ä½•ä» Univer ä¸­å­˜å‚¨æ•°æ®ã€‚

### åŠ è½½æ•°æ®

é€šè¿‡è°ƒç”¨ `univerAPI` çš„ `createUniverSheet` æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ `Workbook` å®ä¾‹ã€‚æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† `Workbook` çš„æ•°æ®ï¼Œåº”è¯¥ç¬¦åˆ `IWorkbookData` æ¥å£ã€‚

```typescript
import { IWorkbookData, UniverInstanceType } from "@univerjs/core";

const data: IWorkbookData = {
  id: 'test',
  sheets: {
    sheet1: {
      id: 'sheet1',
      name: 'sheet1',
      cellData: {
        0: {
          0: {
            v: 'Hello Univer!',
          },
        },

      },
      rowCount: 100,
      columnCount: 100,
    },
  },
  locale: LocaleType.ZH_CN,
  name: 'Test Workbook',
  sheetOrder: ['sheet1'],
};
const workbook = univerAPI.createUniverSheet(data);
```

<Callout type="error">
  TODO: @jikkai è¿™é‡Œéœ€è¦ç»™ presets æ‰“ UMD åŒ…å¹¶æŒ‡å¯¼ç”¨æˆ·å¼•å…¥
</Callout>

export const code2 = `const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: zhCN,
  },
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
});

univer.registerPlugin(UniverDocsPlugin);
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);

const data = {
        id: 'test',
        appVersion: '3.0.0-alpha',
        sheets: {
            sheet1: {
                id: 'sheet1',
                name: 'sheet1',
                cellData: {
                    0: {
                        0: {
                            v: 'Hello Univer!',
                        },
                    },
                    
                },
                rowCount: 100,
                columnCount: 100,
            },
        },
        locale: LocaleType.ZH_CN,
        name: '',
        sheetOrder: ['sheet1'],
        styles: {},
        resources: [
        ],
    };

univer.createUnit(UniverInstanceType.UNIVER_SHEET, data);`

<ReactLive code={code2} />

ä½ å¯ä»¥åœ¨ [å·¥ä½œè¡¨æ•°æ®ç»“æ„](http://localhost:3000/zh-CN/guides/sheet/getting-started/workbook-data) è¿›ä¸€æ­¥äº†è§£å¦‚ä½•åˆå§‹åŒ–è¡¨æ ¼æ•°æ®ã€‚

### ä¿®æ”¹æ•°æ®

ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ `univerAPI` çš„æ–¹æ³•æ¥ä½¿ç”¨ Univer äº†ï¼Œä¾‹å¦‚è·å–å½“å‰æ¿€æ´»çš„ï¼Œå¹¶åœ¨æŒ‡å®šçš„èŒƒå›´æ›´æ–°å€¼ï¼š

```typescript
const sheet = univerAPI.getActiveWorkbook().getActiveSheet();

const range = sheet.getRange(0, 0, 1, 1);
range.setValue(1);
```

<Callout type="error" emoji="ğŸš¨">
  Univer åŸºäº [å‘½ä»¤ç³»ç»Ÿ](/guides/sheet/architecture/univer#%E5%91%BD%E4%BB%A4%E7%B3%BB%E7%BB%9F) å¯¹çŠ¶æ€å’Œæ•°æ®è¿›è¡Œæ“ä½œå’Œæ›´æ–°ï¼Œå› æ­¤ä½ **å¿…é¡»**ä½¿ç”¨ Facade APIï¼ˆæˆ–å…¶å¯¹åº”çš„å‘½ä»¤ï¼‰æ¥æ›´æ–°æ•°æ®ï¼Œä»»ä½•ç›´æ¥å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ä»¥æ›´æ–°è§†å›¾çš„æ“ä½œéƒ½ä¸ä¼šç”Ÿæ•ˆã€‚
</Callout>

### å­˜å‚¨æ•°æ®

é€šè¿‡è°ƒç”¨ `workbook` çš„ `save` æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ° `IWorkbookData` å¯¹è±¡ï¼ŒåŒ…å«è¡¨æ ¼å†…éƒ¨çš„æœ€æ–°æ•°æ®ã€‚

```typescript
const savedData = univerAPI.getActiveWorkbook().save();
```

## ä¸‹ä¸€æ­¥

* åœ¨ [åŸºç¡€æ¦‚å¿µ](/guides/sheet/getting-started/concepts) ç« èŠ‚äº†è§£æœ¬ç« ä¸­å‡ºç°çš„æ’ä»¶ã€å‘½ä»¤å’Œ Facade API ç­‰æ¦‚å¿µã€‚
* åœ¨ [Presets](/guides/sheet/getting-started/presets) ç« èŠ‚äº†è§£ Univer å®˜æ–¹æä¾›çš„æ‰€æœ‰ Presetsã€‚
* åœ¨ [å·¥ä½œè¡¨æ•°æ®ç»“æ„](/guides/sheet/getting-started/workbook-data) è¿›ä¸€æ­¥äº†è§£å¦‚ä½•åˆå§‹åŒ–è¡¨æ ¼æ•°æ®ã€‚
* åœ¨ [åŠŸèƒ½](/guides/sheet/features/core) ç›¸å…³ç« èŠ‚ä¸­äº†è§£ä¿®æ”¹ç”µå­è¡¨æ ¼æ•°æ®çš„æ‰€æœ‰æ“ä½œã€‚

[^1]: https://blog.npmjs.org/post/110924823920/npm-weekly-5
[^2]: https://pnpm.io/npmrc#auto-install-peers
[^3]: https://github.com/yarnpkg/yarn/issues/1503
